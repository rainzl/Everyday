<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title></title>
<style>
p {
	margin: 0;
}
ul {
	margin: 0;
	padding: 0;
	list-style: none;
}
dl {
	margin: 0 auto;
	width: 600px;
}
#form {
	margin: 50px auto;
	padding: 50px;
	width: 600px;
	background-color: #ddd;
	text-align: center;
}
#form li {
	padding: 10px 0;
	overflow: hidden;
}
#form li label {
	float: left;
	padding-right: 10px;
	width: 90px;
	text-align: right;
}
#form li input {
	float: left;
	width: 360px;
	outline: none;
	text-align: left;
}
#form li p {
	float: left;
	padding-left: 10px;
	width: 100px;
	text-align: left;
	font-size: 12px;
	line-height: 18px;
	color: #666;
}
#submit {
	margin-top: 10px;
	height: 30px;
	width: 100px;
	cursor: pointer;
}
</style>
</head>
<body>
	<form id="form" action="../textOwn/音频播放网站第四版/loading/loading.html">
		<ul>
			<li id="phoneNum">
				<label>电话号码</label>
				<input type="text" />
				<p>这里显示校验结果</p>
			</li>
			<li id="identify">
				<label>身份证号码</label>
				<input type="text" />
				<p>这里显示校验结果</p>
			</li>
			<li id="email">
				<label>邮箱</label>
				<input type="text" />
				<p>这里显示校验结果</p>
			</li>
			<li id="qq">
				<label>qq号码</label>
				<input type="text" />
				<p>这里显示校验结果</p>
			</li>
			<li id="birthday">
				<label>生日</label>
				<input type="text" />
				<p>这里显示校验结果</p>
			</li>
		</ul>
		<input id="submit" type="submit" value="开始验证" />
	</form>
	<div>
		<dl>
			<dt>表单说明</dt>
			<dd>电话号码： 只能填写正确的电话号码</dd>
			<dd>身份证号码： 只能填写正确的身份证号码</dd>
			<dd>邮箱：邮箱名称最少两位，只能以com/cn/com.cn结尾 </dd>
			<dd>qq：最少五位，最多六位数字 </dd>
			<dd>生日：支持输入格式：年(其他)月(其他)日(其他);你年龄不能超过80岁，不能小于0岁</dd>
		</dl>
	</div>
<script>
var jsonVerification = {
	phone: /^1([3|5|7|8][0-9]|14[7|5])\d{8}$/,
	identify: /^[1-9](\d{14}|\d{17}|\d{16}x)$/,
	email: /^[a-z]\w+@[a-z0-9]+.(com|cn|com.cn)$/,
	qq: /^[1-9][0-9]{4,11}$/,
	birthday: /^\d{4}(\D+\d{1,2}){2}(\D+)?$/
}

	
	var oSubmit = document.getElementById('submit');
	var form = document.getElementById('form');
	var aLis = form.getElementsByTagName('li');
	for (var i=0; i<aLis.length; i++) {
		aLis[i].children[1].addEventListener('blur',fnBlur);
		
		function fnBlur(){
			if (this.value) {
				var ver = new fnVerification(this.parentNode.id);
				switch (this.parentNode.id) {
					case 'phoneNum':
						ver.verifi(jsonVerification.phone,function(obj1,obj2){
							obj1.style.borderColor = '';
							obj2.innerHTML = '是电话号码';
						},function(obj1,obj2){
							obj1.style.borderColor = 'red';
							obj2.innerHTML = '不是电话号码';
						});
						break;
					case 'identify':
						ver.verifi(jsonVerification.identify,function(obj1,obj2){
							obj1.style.borderColor = '';
							obj2.innerHTML = '是身份证号码';
						},function(obj1,obj2){
							obj1.style.borderColor = 'red';
							obj2.innerHTML = '不是身份证号码';
						});
						break;
					case 'email':
						ver.verifi(jsonVerification.email,function(obj1,obj2){
							obj1.style.borderColor = '';
							obj2.innerHTML = '是邮箱';
						},function(obj1,obj2){
							obj1.style.borderColor = 'red';
							obj2.innerHTML = '不是邮箱';
						});
						break;
					case 'qq':
						ver.verifi(jsonVerification.qq,function(obj1,obj2){
							obj1.style.borderColor = '';
							obj2.innerHTML = '是qq号码';
						},function(obj1,obj2){
							obj1.style.borderColor = 'red';
							obj2.innerHTML = '不是qq号码';
						});
						break;
					case 'birthday':
						ver.verifi(jsonVerification.birthday,fnBirthday,function(obj1,obj2){
							obj1.style.borderColor = 'red';
							obj2.innerHTML = '日期格式不正确';
						});
						break;
				}
			} else {
				this.style.borderColor = '';
				this.nextElementSibling.innerHTML = '这里显示校验结果';
			}
			
		}
	}
	form.onsubmit = function () {
		var onOff = true;
		for (var i=0; i<aLis.length; i++) {
			
			if ( aLis[i].children[1].style.borderColor == 'red' || aLis[i].children[1].value == '' ) {
				aLis[i].children[1].focus();
				aLis[i].children[1].style.borderColor = 'red';
				onOff = false;
			}
		}
		return onOff;
	}
	function fnBirthday(obj1,obj2) {
		//obj1: 输入框,obj2: 提示框
		//判断日期是否符合条件，如果满足条件，就通过，否则不通过
		
		var arrBir = obj1.value.match(/\d+/g);
		var birDate = new Date(arrBir[0],arrBir[1]%12,arrBir[2]);
		var year = birDate.getFullYear(),
			month = birDate.getMonth()==0? 12: birDate.getMonth(),
			day = birDate.getDate();
		console.log(year,arrBir[0],month,arrBir[1],day,arrBir[2])
		if ( year == arrBir[0] && month == arrBir[1] && day == arrBir[2] ) {
			var nowDate = new Date();
			if (nowDate-birDate<=10000||nowDate-birDate>=(80*365*24*60*60*1000)) {
				obj1.style.borderColor = 'red';
				obj2.innerHTML = '年龄不在规定范围';
			} else {
				obj1.style.borderColor = '';
				obj2.innerHTML = '生日日期正确';
			}
			
		} else {
			obj1.style.borderColor = 'red';
			obj2.innerHTML = '日期格式不正确';
		}
	}
	//函数对象
	function fnVerification(id) {
		this.obj = document.getElementById(id);
		this.aChild = this.obj.children;
	}
	fnVerification.prototype.verifi = function (re,fnSucce,fnFail){
		if ( re.test(this.aChild[1].value) ) {
			fnSucce&&fnSucce(this.aChild[1],this.aChild[2]);
		} else {
			fnFail&&fnFail(this.aChild[1],this.aChild[2]);
		}
	}

</script>
</body>
</html>
