<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title></title>
<style>
body {
	margin: 0;
}
span {
	position: absolute;
	top: 0;
	left: 0;
	width: 10px;
	height: 10px;
	border-radius: 50%;
	background-color: #00BFFF;
	text-align: center;
}
span img {
	width: 100px;
	height: 100px;
	position: absolute;
	left: -45px;
	top: -45px;

}
.wrap {
	box-sizing: border-box;
	position: relative;
	/*border: 1px solid #000000;*/
}
.tank {
	position: absolute;
	top: 0;
	left: 0;
	width: 38px;
	height: 38px;
	background: url(img6/tnak.png) no-repeat;
}
.top {
	background-position: 0 0 !important;
}
.right {
	background-position: -38px 0 !important;
}
.bottom {
	background-position: -76px 0 !important;
}
.left {
	background-position: -114px 0 !important;
}
</style>
</head>
<body>
	<section class="wrap">
		<div class="tank top"></div>
	</section>
<script src="JS/publicMain.js"></script>
<script>
var boomData = [
	'img6/img1.png',
	'img6/img2.png',
	'img6/img3.png',
	'img6/img4.png',
	'img6/img5.png',
	'img6/img6.png',
	'img6/img8.png'
];
var oWrap = document.getElementsByClassName('wrap')[0];
var oTank = document.getElementsByClassName('tank')[0];

var screenW = document.documentElement.clientWidth || document.body.clientWidth;
var screenH = document.documentElement.clientHeight || document.body.clientHeight;
oWrap.style.width = screenW + 'px';
oWrap.style.height = screenH + 'px';
var keyOff = true;

window.onkeyup = function () {
	keyOff = false;
}

window.onkeydown = function (ev) {
	
	var ev = ev || event;
	var code = ev.keyCode;
	
	var tTop = oTank.offsetTop;
	var tLeft = oTank.offsetLeft;
	var tWidth = oTank.offsetWidth;
	var tHeight = oTank.offsetHeight;
	var now = 0;
	switch (code) {
		case 37:
			addClass('left');
			now = tLeft - 5;
			if ( now < 0 ) {
				now = 0;
				return;
			}
			oTank.style.left = now + 'px';
			break;
		case 38:
			addClass('top');
			now = tTop - 5;
			if ( now < 0 ) {
				now = 0;
				return;
			}
			oTank.style.top = now + 'px';
			break;
		case 39:
			addClass('right');
			now = tLeft + 5;
			if ( now > screenW - tWidth ) {
				now = screenW - tWidth;
				return;
			}
			oTank.style.left = now + 'px';
			break;
		case 40:
			addClass('bottom');
			now = tTop + 5;
			if ( now > screenH - tHeight ) {
				now = screenH - tHeight;
				return;
			}
			oTank.style.top = now + 'px';
			break;
		case 32:
			if ( keyOff ) {
				return;
			}
			keyOff = true;
			boom();
			break;
	}
}
function boom() {
	var tTop = oTank.offsetTop;
	var tLeft = oTank.offsetLeft;
	var tWidth = oTank.offsetWidth;
	var tHeight = oTank.offsetHeight;
	
	var span = document.createElement('span');
	var img = document.createElement('img');
	var now = 0;
	img.src = boomData[now];
	if ( oTank.classList.contains('left') ) {
		span.style.top = tTop + 14 + 'px';
		span.style.left = tLeft - 10 + 'px';
		oWrap.appendChild(span);
		mTween(span,{'left':0},400,'linear',boom2);
	} else if ( oTank.classList.contains('top') ) {
		span.style.top = tTop - 10 + 'px';
		span.style.left = tLeft + 14 + 'px';
		oWrap.appendChild(span);
		mTween(span,{'top':0},400,'linear',boom2);
	} else if ( oTank.classList.contains('right') ){
		span.style.top = tTop + 14 + 'px';
		span.style.left = tLeft + 48 + 'px';
		oWrap.appendChild(span);
		mTween(span,{'left':screenW - tWidth},400,'linear',boom2);
	} else if ( oTank.classList.contains('bottom') ) {
		span.style.top = tTop + 48 + 'px';
		span.style.left = tLeft + 14 + 'px';
		oWrap.appendChild(span);
		
		mTween(span,{'top':screenH - tHeight},400,'linear',boom2);
	}
	function boom2(){
		span.appendChild(img);
		var timer = 0;
		timer = setInterval(function(){
			if ( now >= boomData.length-1 ) {
				clearInterval(timer);
				oWrap.removeChild(span);
			} else {
				now ++;
				console.log(boomData[now]);
				img.src = boomData[now];
			}
		},200);
	}
	
}



function addClass(className) {
	oTank.className = 'tank';
	oTank.classList.add(className);
}
</script>
</body>
</html>
