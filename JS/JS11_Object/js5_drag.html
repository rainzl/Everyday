<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title></title>
<style>
div {
	position: absolute;
	width: 100px;
	height: 100px;
}
#box1 {
	top: 0;
	left: 0;
	background-color: #00BFFF;
}
#box2 {
	top: 0;
	left: 100px;
	background-color: green;
}
</style>
</head>
<body>
	<div id="box1"></div>
	<div id="box2"></div>
</body>
<script>
(function(){
	
	function Drag(id) {
		this.obj = document.getElementById(id);
		this.disX = 0;
		this.disY = 0;
	}
	Drag.prototype.init = function () {
		var that = this;
		this.obj.addEventListener('mousedown',fnDown);
		function fnDown(ev) {
			var ev = ev || event;
			that.down(ev);
			ev.preventDefault();
		}
	}
	Drag.prototype.down = function(ev) {
		var that = this;
		this.disX = ev.pageX - this.obj.offsetLeft;
		this.disY = ev.pageY - this.obj.offsetTop;
		document.addEventListener('mousemove',fnMove);
		this.up(fnMove);
		function fnMove(ev) {
			var ev = ev || event;
			that.move(ev);
		}
	}
	Drag.prototype.up = function (fnMove) {
		document.addEventListener('mouseup',fnUp);
		function fnUp() {
			document.removeEventListener('mousemove',fnMove);
			document.removeEventListener('mouseup',fnUp);
		}
	}
	Drag.prototype.move = function(ev) {
		this.obj.style.left = ev.pageX - this.disX + 'px';
		this.obj.style.top = ev.pageY - this.disY + 'px';
	}
	
	//继承父级的原型链
	function Drag2(id) {
		Drag.call(this,id);
		this.W = 0;
		this.H = 0;
	}
	
	extend(Drag2.prototype,Drag.prototype);
	
	Drag2.prototype.move = function (ev) {
		var l = ev.pageX - this.disX,
			t = ev.pageY - this.disY;
		this.W = document.documentElement.clientWidth || document.body.clientWidth;
		this.H = document.documentElement.clientHeight || document.body.clientHeight;
		if ( t<=0 ) {
			t = 0;
		} else if (t>this.H - this.obj.offsetHeight) {
			t = this.H - this.obj.offsetHeight;
		}
		if ( l<=0 ) {
			l = 0;
		} else if (l>this.W - this.obj.offsetWidth) {
			l = this.W - this.obj.offsetWidth;
		}
		this.obj.style.left = l + 'px';
		this.obj.style.top = t + 'px';
	}
	
	
	
	
	
	var box = new Drag('box1');
	var box2 = new Drag2('box2');
	box2.init();
	box.init();
	
	
	
	//封装一个extend函数2
	function extend(obj,obj2) {
		for ( var attr in obj2 ) {
			if ( obj2.hasOwnProperty(attr) ) {
				obj[attr] = obj2[attr];
			}
		}
	}
	
	//封装一个extend函数1
	/*function extend(obj,obj2) {
		for ( var attr in obj2 ) {
			if ( typeof obj2[attr] == 'object' ) {
				var o = obj2[attr].push?[]: {};
				extend(o,obj2[attr]);
				obj[attr] = o;
			} else {
				obj[attr] = obj2[attr];
			}
		}
	}*/
})()
</script>
</html>
